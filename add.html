<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="style.css">

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script src="api.js"></script>
</head>

<body>
<div class="card">
<h2>➕ 宿題追加</h2>

<div class="subjects" id="subjects"></div>

<textarea id="text" placeholder="宿題内容"></textarea>
<input type="date" id="date">

<button onclick="send()">登録</button>
</div>

<script>
const SUBJECTS = ["国語","数学","理科","社会","英語","音楽","美術","保体","その他"];
let subject = null;

(async () => {
  await initLiff();
})();

const box = document.getElementById("subjects");

SUBJECTS.forEach(s => {
  const b = document.createElement("button");
  b.innerText = s;
  b.onclick = () => {
    document.querySelectorAll(".subjects button").forEach(x => x.classList.remove("active"));
    b.classList.add("active");
    subject = s;
  };
  box.appendChild(b);
});

async function send() {
  if (!subject || !text.value || !date.value) return;

  await post({
    action: "addHomework",
    subject,
    text: text.value,
    date: date.value   // ← YYYY-MM-DD（GAS側で整形）
  });

  liff.closeWindow();
}
</script>
</body>
</html>

